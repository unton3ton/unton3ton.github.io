<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä —Ñ–æ—Ç–æ ‚Üî —Å—Ç—Ä–æ–∫–∞</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #ff9a00 0%, #ff6a00 100%);
      color: #333;
      margin: 0;
      padding: 20px;
      min-height: 100vh;
    }
    
    .container {
      max-width: 1600px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      min-height: 80vh;
    }
    
    h1 {
      text-align: center;
      color: #ff6a00;
      font-size: 2.2em;
      margin-bottom: 30px;
      grid-column: 1 / -1;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .panel {
      background: #fffaf5;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 4px 15px rgba(255, 106, 0, 0.1);
      border: 1px solid #ffe0cc;
    }
    
    .panel h2 {
      color: #cc5500;
      margin-bottom: 20px;
      font-size: 1.4em;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .section {
      margin-bottom: 25px;
    }
    
    label {
      display: block;
      margin-bottom: 12px;
      font-weight: 600;
      color: #cc5500;
      font-size: 1.1em;
    }
    
    input[type="file"] {
      width: 100%;
      margin-bottom: 15px;
      padding: 15px;
      border: 2px dashed #ffa366;
      border-radius: 8px;
      background: #fff5eb;
      font-size: 14px;
      transition: all 0.3s ease;
    }
    
    input[type="file"]:hover {
      border-color: #ff6a00;
      background: #ffebd9;
    }
    
    textarea {
      width: 100%;
      height: 180px;
      padding: 15px;
      border: 2px solid #ffa366;
      border-radius: 8px;
      font-family: 'Consolas', 'Monaco', monospace;
      resize: vertical;
      font-size: 13px;
      line-height: 1.4;
      transition: border-color 0.3s ease;
      background: #fffaf5;
    }
    
    textarea:focus {
      outline: none;
      border-color: #ff6a00;
      box-shadow: 0 0 0 3px rgba(255, 106, 0, 0.1);
    }
    
    .button-group {
      display: flex;
      gap: 12px;
      margin: 15px 0;
      flex-wrap: wrap;
    }
    
    button {
      background: linear-gradient(135deg, #ff9a00 0%, #ff6a00 100%);
      color: white;
      border: none;
      padding: 14px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      flex: 1;
      min-width: 160px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(255, 106, 0, 0.2);
      position: relative;
      overflow: hidden;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 106, 0, 0.3);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    button.secondary {
      background: linear-gradient(135deg, #ff8c42 0%, #e65c00 100%);
      box-shadow: 0 4px 15px rgba(255, 140, 66, 0.2);
    }
    
    button.secondary:hover {
      box-shadow: 0 6px 20px rgba(255, 140, 66, 0.3);
    }
    
    .file-input-wrapper {
      position: relative;
      flex: 1;
      min-width: 160px;
    }
    
    .file-input-wrapper input[type="file"] {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
      margin: 0;
      padding: 0;
      z-index: 2;
    }
    
    .file-input-button {
      display: block;
      width: 100%;
      text-align: center;
      margin: 0;
      pointer-events: none;
      z-index: 1;
      position: relative;
    }
    
    .preview-container {
      margin-top: 20px;
      text-align: center;
    }
    
    .preview {
      border: 2px dashed #ffa366;
      border-radius: 8px;
      padding: 20px;
      min-height: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fffaf5;
      transition: border-color 0.3s ease;
    }
    
    .preview:hover {
      border-color: #ff6a00;
    }
    
    .preview img {
      max-width: 100%;
      max-height: 300px;
      border-radius: 6px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    
    .preview-placeholder {
      color: #ff8c42;
      font-style: italic;
    }
    
    .status {
      padding: 12px 16px;
      margin: 15px 0;
      border-radius: 8px;
      font-weight: 500;
      text-align: center;
      transition: all 0.3s ease;
    }
    
    .status.success {
      background: #ffe6cc;
      color: #cc5500;
      border: 1px solid #ffd9b3;
    }
    
    .status.error {
      background: #ffddcc;
      color: #cc4400;
      border: 1px solid #ffccb3;
    }
    
    .status.info {
      background: #fff0e0;
      color: #cc5500;
      border: 1px solid #ffddcc;
    }
    
    .tools-panel {
      grid-column: 1 / -1;
      background: #fffaf5;
      border-radius: 12px;
      padding: 20px;
      margin-top: 10px;
      border: 1px solid #ffe0cc;
    }
    
    .tools-panel h3 {
      color: #cc5500;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .tool-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
    }
    
    .file-info {
      background: #ffe6cc;
      padding: 10px 15px;
      border-radius: 6px;
      margin: 10px 0;
      font-size: 0.9em;
      color: #cc5500;
    }
    
    /* –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –ü–ê–ù–ï–õ–ò –°–ñ–ê–¢–ò–Ø */
    .compression-panel {
      grid-column: 1 / -1;
      background: #fffaf5;
      border-radius: 12px;
      padding: 25px;
      margin-top: 20px;
      border: 1px solid #ffe0cc;
      box-shadow: 0 4px 15px rgba(255, 106, 0, 0.1);
    }
    
    .compression-grid {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 20px;
      align-items: start;
    }
    
    .compression-column {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .compression-stats {
      background: #ffe6cc;
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }
    
    .stat-box {
      background: white;
      padding: 15px;
      border-radius: 6px;
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .stat-value {
      font-size: 1.5em;
      font-weight: bold;
      color: #ff6a00;
      margin-bottom: 5px;
    }
    
    .stat-label {
      font-size: 0.9em;
      color: #cc5500;
    }
    
    .compression-center {
      display: flex;
      flex-direction: column;
      gap: 15px;
      align-items: center;
      justify-content: center;
      padding: 20px 0;
    }
    
    .compression-buttons {
      display: flex;
      flex-direction: column;
      gap: 10px;
      width: 100%;
    }
    
    .compression-buttons button {
      min-width: 100%;
    }
    
    .compression-algorithms {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin: 15px 0;
      width: 100%;
    }
    
    .algorithm-btn {
      background: #fff5eb;
      border: 2px solid #ffa366;
      color: #cc5500;
      padding: 10px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
      text-align: center;
    }
    
    .algorithm-btn.active {
      background: #ff6a00;
      color: white;
      border-color: #ff6a00;
    }
    
    .algorithm-btn:hover:not(.active) {
      background: #ffebd9;
      border-color: #ff6a00;
    }
    
    .log-output {
      background: #2c3e50;
      color: #ecf0f1;
      padding: 15px;
      border-radius: 8px;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 12px;
      max-height: 200px;
      overflow-y: auto;
      margin-top: 15px;
    }
    
    .log-entry {
      margin-bottom: 8px;
      padding-bottom: 8px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    
    .column-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .column-header h3 {
      color: #cc5500;
      font-size: 1.1em;
      margin: 0;
    }
    
    .copy-btn-small {
      background: #ffa366;
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 500;
      transition: all 0.2s ease;
    }
    
    .copy-btn-small:hover {
      background: #ff8c42;
    }
    
    /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .panel, .compression-panel {
      animation: fadeIn 0.5s ease-out;
    }
    
    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
    @media (max-width: 1200px) {
      .compression-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }
      
      .compression-center {
        order: -1;
        padding: 0;
      }
    }
    
    @media (max-width: 768px) {
      .container {
        grid-template-columns: 1fr;
        padding: 20px;
        gap: 20px;
      }
      
      h1 {
        font-size: 1.8em;
      }
      
      .button-group {
        flex-direction: column;
      }
      
      button, .file-input-wrapper {
        width: 100%;
        min-width: auto;
      }
      
      body {
        padding: 10px;
      }
      
      .compression-buttons {
        flex-direction: column;
      }
      
      .compression-algorithms {
        flex-direction: row;
        flex-wrap: wrap;
      }
      
      .algorithm-btn {
        flex: 1;
        min-width: 120px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üñºÔ∏è –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚Üî Base64</h1>
    
    <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ Base64 -->
    <div class="panel">
      <h2>üì∑ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üí Base64</h2>
      
      <div class="section">
        <label>–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:</label>
        <input type="file" id="imageInput" accept="image/*" />
        <div class="file-info" id="fileInfo" style="display: none;"></div>
        
        <div class="button-group">
          <button id="convertToTextBtn">üîÑ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ Base64</button>
        </div>
        
        <div class="preview-container">
          <div class="preview" id="inputPreview">
            <div class="preview-placeholder">–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å: Base64 –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
    <div class="panel">
      <h2>üìÑ Base64 ‚Üí –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</h2>
      
      <div class="section">
        <label>–°—Ç—Ä–æ–∫–∞ Base64:</label>
        <textarea id="base64String" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ Base64 —Å—Ç—Ä–æ–∫—É –∏–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –µ—ë –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è..."></textarea>
        
        <div class="button-group">
          <button id="convertToImageBtn">üñºÔ∏è –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</button>
          <div class="file-input-wrapper">
            <input type="file" id="txtInput" accept=".txt" />
            <button class="file-input-button secondary">üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ TXT</button>
          </div>
        </div>
        
        <div class="preview-container">
          <div class="preview" id="outputPreview">
            <div class="preview-placeholder">–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- –ù–û–í–ê–Ø –ü–ê–ù–ï–õ–¨: –°–∂–∞—Ç–∏–µ Base64 -->
    <div class="compression-panel">
      <h2>üì¶ –°–∂–∞—Ç–∏–µ Base64 —Å—Ç—Ä–æ–∫</h2>
      
      <div class="compression-grid">
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –ò—Å—Ö–æ–¥–Ω—ã–π Base64 -->
        <div class="compression-column">
          <div class="column-header">
            <h3>–ò—Å—Ö–æ–¥–Ω—ã–π Base64</h3>
            <button class="copy-btn-small" id="copyOriginalBtn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
          </div>
          <textarea id="compressionInput" placeholder="Base64 —Å—Ç—Ä–æ–∫–∞ –¥–ª—è —Å–∂–∞—Ç–∏—è..."></textarea>
          <div class="button-group">
            <button id="validateOriginalBtn">‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
            <button id="loadFromImageBtn">üñºÔ∏è –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</button>
          </div>
        </div>
        
        <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
        <div class="compression-center">
          <div class="compression-algorithms" id="algorithmButtons">
            <button class="algorithm-btn active" data-algorithm="gzip">Gzip</button>
            <button class="algorithm-btn" data-algorithm="deflate">Deflate</button>
            <button class="algorithm-btn" data-algorithm="deflate-raw">Deflate-raw</button>
          </div>
          
          <div class="compression-buttons">
            <button id="compressBtn" class="secondary">üì¶ –°–∂–∞—Ç—å ‚Üí</button>
            <button id="decompressBtn" class="secondary">‚Üê –†–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å</button>
            <button id="autoCompressBtn">üîÅ –ê–≤—Ç–æ-—Å–∂–∞—Ç–∏–µ</button>
            <button id="compareBtn">üìä –°—Ä–∞–≤–Ω–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã</button>
          </div>
          
          <div class="compression-buttons">
            <button id="swapFieldsBtn">üîÑ –ü–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏</button>
            <button id="clearCompressionBtn">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
          </div>
        </div>
        
        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –°–∂–∞—Ç—ã–π –∏ –†–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–π Base64 -->
        <div class="compression-column">
          <div class="column-header">
            <h3>–°–∂–∞—Ç—ã–π Base64</h3>
            <button class="copy-btn-small" id="copyCompressedBtn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
          </div>
          <textarea id="compressionOutput" placeholder="–°–∂–∞—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å..." readonly></textarea>
          <div class="button-group">
            <button id="useForImageBtn">üñºÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</button>
            <button id="saveCompressedBtn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ TXT</button>
          </div>
          
          <div class="column-header" style="margin-top: 20px;">
            <h3>–†–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–π Base64</h3>
            <button class="copy-btn-small" id="copyDecompressedBtn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
          </div>
          <textarea id="decompressedOutput" placeholder="–†–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å..." readonly></textarea>
          <div class="button-group">
            <button id="useDecompressedBtn">üñºÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–π</button>
            <button id="verifyIntegrityBtn">‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å</button>
          </div>
        </div>
      </div>
      
      <div class="compression-stats">
        <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∂–∞—Ç–∏—è</h3>
        <div class="stats-grid" id="statsGrid">
          <div class="stat-box">
            <div class="stat-value" id="originalSize">0</div>
            <div class="stat-label">–ò—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="compressedSize">0</div>
            <div class="stat-label">–°–∂–∞—Ç—ã–π —Ä–∞–∑–º–µ—Ä</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="compressionRatio">0%</div>
            <div class="stat-label">–°—Ç–µ–ø–µ–Ω—å —Å–∂–∞—Ç–∏—è</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="algorithmUsed">-</div>
            <div class="stat-label">–ê–ª–≥–æ—Ä–∏—Ç–º</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="decompressedSize">0</div>
            <div class="stat-label">–†–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä</div>
          </div>
          <div class="stat-box">
            <div class="stat-value" id="integrityStatus">-</div>
            <div class="stat-label">–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å</div>
          </div>
        </div>
      </div>
      
      <div class="log-output" id="compressionLog">
        <div class="log-entry">–ñ—É—Ä–Ω–∞–ª —Å–∂–∞—Ç–∏—è: –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ</div>
      </div>
    </div>
    
    <!-- –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ -->
    <div class="tools-panel">
      <h3>üõ†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h3>
      <div class="tool-buttons">
        <button id="saveToTxtBtn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å Base64 –≤ TXT</button>
        <button id="clearAllBtn">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë</button>
        <button id="copyBase64Btn">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å Base64</button>
        <button id="validateBase64Btn">‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Base64</button>
      </div>
    </div>
    
    <div id="statusMessage" class="status" style="display: none;"></div>
  </div>

  <script>
    // –≠–ª–µ–º–µ–Ω—Ç—ã DOM –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Å—Ç–∏
    const elements = {
      imageInput: document.getElementById('imageInput'),
      txtInput: document.getElementById('txtInput'),
      base64Textarea: document.getElementById('base64String'),
      inputPreview: document.getElementById('inputPreview'),
      outputPreview: document.getElementById('outputPreview'),
      statusMessage: document.getElementById('statusMessage'),
      fileInfo: document.getElementById('fileInfo'),
      convertToTextBtn: document.getElementById('convertToTextBtn'),
      convertToImageBtn: document.getElementById('convertToImageBtn'),
      saveToTxtBtn: document.getElementById('saveToTxtBtn'),
      clearAllBtn: document.getElementById('clearAllBtn'),
      copyBase64Btn: document.getElementById('copyBase64Btn'),
      validateBase64Btn: document.getElementById('validateBase64Btn')
    };

    // –≠–ª–µ–º–µ–Ω—Ç—ã DOM –¥–ª—è —Å–∂–∞—Ç–∏—è
    const compressionElements = {
      input: document.getElementById('compressionInput'),
      output: document.getElementById('compressionOutput'),
      decompressed: document.getElementById('decompressedOutput'),
      compressBtn: document.getElementById('compressBtn'),
      decompressBtn: document.getElementById('decompressBtn'),
      autoCompressBtn: document.getElementById('autoCompressBtn'),
      compareBtn: document.getElementById('compareBtn'),
      copyOriginalBtn: document.getElementById('copyOriginalBtn'),
      copyCompressedBtn: document.getElementById('copyCompressedBtn'),
      copyDecompressedBtn: document.getElementById('copyDecompressedBtn'),
      useForImageBtn: document.getElementById('useForImageBtn'),
      saveCompressedBtn: document.getElementById('saveCompressedBtn'),
      useDecompressedBtn: document.getElementById('useDecompressedBtn'),
      verifyIntegrityBtn: document.getElementById('verifyIntegrityBtn'),
      validateOriginalBtn: document.getElementById('validateOriginalBtn'),
      loadFromImageBtn: document.getElementById('loadFromImageBtn'),
      swapFieldsBtn: document.getElementById('swapFieldsBtn'),
      clearCompressionBtn: document.getElementById('clearCompressionBtn'),
      algorithmButtons: document.getElementById('algorithmButtons'),
      originalSize: document.getElementById('originalSize'),
      compressedSize: document.getElementById('compressedSize'),
      decompressedSize: document.getElementById('decompressedSize'),
      compressionRatio: document.getElementById('compressionRatio'),
      algorithmUsed: document.getElementById('algorithmUsed'),
      integrityStatus: document.getElementById('integrityStatus'),
      compressionLog: document.getElementById('compressionLog')
    };

    // –¢–µ–∫—É—â–∏–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º
    let currentAlgorithm = 'gzip';

    // –§—É–Ω–∫—Ü–∏–∏ —Å–∂–∞—Ç–∏—è/—Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏
    async function compress(string, encoding) {
      const byteArray = new TextEncoder().encode(string);
      const cs = new CompressionStream(encoding);
      const writer = cs.writable.getWriter();
      writer.write(byteArray);
      writer.close();
      return new Response(cs.readable).arrayBuffer();
    }

    async function decompress(byteArray, encoding) {
      const cs = new DecompressionStream(encoding);
      const writer = cs.writable.getWriter();
      writer.write(byteArray);
      writer.close();
      const arrayBuffer = await new Response(cs.readable).arrayBuffer();
      return new TextDecoder().decode(arrayBuffer);
    }

    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    function arrayBufferToBase64(buffer) {
      const bytes = new Uint8Array(buffer);
      let binary = '';
      for (let i = 0; i < bytes.byteLength; i++) {
        binary += String.fromCharCode(bytes[i]);
      }
      return btoa(binary);
    }

    function base64ToArrayBuffer(base64) {
      const binaryString = atob(base64);
      const bytes = new Uint8Array(binaryString.length);
      for (let i = 0; i < binaryString.length; i++) {
        bytes[i] = binaryString.charCodeAt(i);
      }
      return bytes.buffer;
    }

    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å–∂–∞—Ç–∏—è
    function logCompression(message, type = 'info') {
      const time = new Date().toLocaleTimeString();
      const logEntry = document.createElement('div');
      logEntry.className = 'log-entry';
      
      let icon = '‚ÑπÔ∏è';
      if (type === 'success') icon = '‚úÖ';
      if (type === 'error') icon = '‚ùå';
      if (type === 'warning') icon = '‚ö†Ô∏è';
      if (type === 'compress') icon = 'üì¶';
      if (type === 'decompress') icon = 'üìÑ';
      
      logEntry.innerHTML = `<span>[${time}]</span> ${icon} ${message}`;
      compressionElements.compressionLog.appendChild(logEntry);
      compressionElements.compressionLog.scrollTop = compressionElements.compressionLog.scrollHeight;
      
      // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ –ª–æ–≥–µ
      const entries = compressionElements.compressionLog.querySelectorAll('.log-entry');
      if (entries.length > 50) {
        entries[0].remove();
      }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–∂–∞—Ç–∏—è
    function updateCompressionStats(originalSize, compressedSize, decompressedSize, algorithm, integrity = null) {
      compressionElements.originalSize.textContent = formatFileSize(originalSize);
      compressionElements.compressedSize.textContent = formatFileSize(compressedSize);
      compressionElements.decompressedSize.textContent = formatFileSize(decompressedSize);
      
      const ratio = compressedSize > 0 ? ((1 - compressedSize / originalSize) * 100).toFixed(2) : 0;
      compressionElements.compressionRatio.textContent = `${ratio}%`;
      compressionElements.algorithmUsed.textContent = algorithm.toUpperCase();
      
      if (integrity !== null) {
        compressionElements.integrityStatus.textContent = integrity ? '‚úÖ –¶–µ–ª' : '‚ùå –ù–∞—Ä—É—à–µ–Ω–∞';
        compressionElements.integrityStatus.style.color = integrity ? '#2ecc71' : '#e74c3c';
      }
    }

    // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    // –ü–æ–∫–∞–∑ —Å—Ç–∞—Ç—É—Å–∞
    function showStatus(message, type = 'info') {
      elements.statusMessage.textContent = message;
      elements.statusMessage.className = `status ${type}`;
      elements.statusMessage.style.display = 'block';
      
      setTimeout(() => {
        elements.statusMessage.style.display = 'none';
      }, 4000);
    }

    // –ü–æ–∫–∞–∑ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –∫–Ω–æ–ø–∫–µ
    function showButtonLoading(button, text) {
      const originalText = button.innerHTML;
      button.innerHTML = '‚è≥ ' + text;
      button.disabled = true;
      
      return () => {
        button.innerHTML = originalText;
        button.disabled = false;
      };
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
    function initAlgorithmButtons() {
      const buttons = compressionElements.algorithmButtons.querySelectorAll('.algorithm-btn');
      buttons.forEach(btn => {
        btn.addEventListener('click', function() {
          buttons.forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          currentAlgorithm = this.dataset.algorithm;
          logCompression(`–í—ã–±—Ä–∞–Ω –∞–ª–≥–æ—Ä–∏—Ç–º: ${currentAlgorithm.toUpperCase()}`);
        });
      });
    }

    // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Base64 –º–µ–∂–¥—É –æ—Å–Ω–æ–≤–Ω—ã–º –ø–æ–ª–µ–º –∏ –ø–æ–ª–µ–º —Å–∂–∞—Ç–∏—è
    function syncBase64Fields() {
      // –ö–æ–≥–¥–∞ –º–µ–Ω—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–µ –ø–æ–ª–µ Base64, –æ–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª–µ –¥–ª—è —Å–∂–∞—Ç–∏—è
      elements.base64Textarea.addEventListener('input', function() {
        if (this.value.trim()) {
          compressionElements.input.value = this.value;
          updateStatsFromInput();
        }
      });
      
      // –ö–æ–≥–¥–∞ –º–µ–Ω—è–µ—Ç—Å—è –ø–æ–ª–µ –¥–ª—è —Å–∂–∞—Ç–∏—è, –æ–±–Ω–æ–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –ø–æ–ª–µ
      compressionElements.input.addEventListener('input', function() {
        if (this.value.trim()) {
          elements.base64Textarea.value = this.value;
          updateStatsFromInput();
        }
      });
      
      // –ö–æ–≥–¥–∞ –º–µ–Ω—è–µ—Ç—Å—è —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω–æ–µ –ø–æ–ª–µ
      compressionElements.decompressed.addEventListener('input', function() {
        updateStatsFromDecompressed();
      });
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –ø–æ–ª—è
    function updateStatsFromInput() {
      const inputText = compressionElements.input.value.trim();
      if (inputText) {
        const originalSize = new TextEncoder().encode(inputText).length;
        updateCompressionStats(originalSize, 0, 0, '-');
      }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–∑ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—è
    function updateStatsFromDecompressed() {
      const decompressedText = compressionElements.decompressed.value.trim();
      if (decompressedText) {
        const decompressedSize = new TextEncoder().encode(decompressedText).length;
        compressionElements.decompressedSize.textContent = formatFileSize(decompressedSize);
      }
    }

    // ========== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô –î–õ–Ø –°–ñ–ê–¢–ò–Ø ==========

    // –°–∂–∞—Ç–∏–µ —Å—Ç—Ä–æ–∫–∏
    compressionElements.compressBtn.addEventListener('click', async function() {
      const inputText = compressionElements.input.value.trim();
      if (!inputText) {
        showStatus('–í–≤–µ–¥–∏—Ç–µ Base64 —Å—Ç—Ä–æ–∫—É –¥–ª—è —Å–∂–∞—Ç–∏—è', 'error');
        return;
      }

      const resetButton = showButtonLoading(this, '–°–∂–∞—Ç–∏–µ...');
      logCompression(`–ù–∞—á–∞–ª–æ —Å–∂–∞—Ç–∏—è (${currentAlgorithm})...`, 'compress');

      try {
        console.time('compress');
        const startTime = performance.now();
        
        const compressedData = await compress(inputText, currentAlgorithm);
        const compressedBase64 = arrayBufferToBase64(compressedData);
        
        const endTime = performance.now();
        console.timeEnd('compress');
        
        compressionElements.output.value = compressedBase64;
        
        const originalSize = new TextEncoder().encode(inputText).length;
        const compressedSize = compressedData.byteLength;
        const timeTaken = (endTime - startTime).toFixed(2);
        
        updateCompressionStats(originalSize, compressedSize, 0, currentAlgorithm);
        logCompression(`–°–∂–∞—Ç–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ: ${formatFileSize(originalSize)} ‚Üí ${formatFileSize(compressedSize)} (${((1 - compressedSize/originalSize)*100).toFixed(2)}% —Å–∂–∞—Ç–∏—è, ${timeTaken}–º—Å)`, 'success');
        
        showStatus(`‚úÖ –°–∂–∞—Ç–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –≠–∫–æ–Ω–æ–º–∏—è: ${((1 - compressedSize/originalSize)*100).toFixed(2)}%`);
        
      } catch (error) {
        logCompression(`–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∂–∞—Ç–∏–∏: ${error.message}`, 'error');
        showStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∂–∞—Ç–∏–∏', 'error');
        console.error('Compression error:', error);
      } finally {
        resetButton();
      }
    });

    // –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ —Å—Ç—Ä–æ–∫–∏
    compressionElements.decompressBtn.addEventListener('click', async function() {
      const compressedText = compressionElements.output.value.trim();
      if (!compressedText) {
        showStatus('–ù–µ—Ç —Å–∂–∞—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏', 'error');
        return;
      }

      const resetButton = showButtonLoading(this, '–†–∞—Å–ø–∞–∫–æ–≤–∫–∞...');
      logCompression('–ù–∞—á–∞–ª–æ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏...', 'decompress');

      try {
        console.time('decompress');
        
        const compressedData = base64ToArrayBuffer(compressedText);
        const decompressedText = await decompress(compressedData, currentAlgorithm);
        
        console.timeEnd('decompress');
        
        compressionElements.decompressed.value = decompressedText;
        
        const originalSize = new TextEncoder().encode(compressionElements.input.value.trim()).length;
        const compressedSize = compressedData.byteLength;
        const decompressedSize = new TextEncoder().encode(decompressedText).length;
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
        const integrity = decompressedText === compressionElements.input.value.trim();
        
        updateCompressionStats(originalSize, compressedSize, decompressedSize, currentAlgorithm, integrity);
        
        if (integrity) {
          logCompression(`–†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: ${decompressedText.length} —Å–∏–º–≤–æ–ª–æ–≤, —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å: ‚úÖ`, 'success');
          showStatus('‚úÖ –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!');
        } else {
          logCompression(`–†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: ${decompressedText.length} —Å–∏–º–≤–æ–ª–æ–≤, —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å: ‚ùå`, 'warning');
          showStatus('‚ö†Ô∏è –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –Ω–æ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –Ω–∞—Ä—É—à–µ–Ω–∞!', 'warning');
        }
        
      } catch (error) {
        logCompression(`–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–µ: ${error.message}`, 'error');
        showStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–µ', 'error');
        console.error('Decompression error:', error);
      } finally {
        resetButton();
      }
    });

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∂–∞—Ç–∏–µ
    compressionElements.autoCompressBtn.addEventListener('click', async function() {
      const inputText = compressionElements.input.value.trim();
      if (!inputText) {
        showStatus('–í–≤–µ–¥–∏—Ç–µ Base64 —Å—Ç—Ä–æ–∫—É –¥–ª—è –∞–≤—Ç–æ-—Å–∂–∞—Ç–∏—è', 'error');
        return;
      }

      const resetButton = showButtonLoading(this, '–ê–≤—Ç–æ-—Å–∂–∞—Ç–∏–µ...');
      logCompression('–ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ-—Å–∂–∞—Ç–∏—è...');
      
      const algorithms = ['gzip', 'deflate', 'deflate-raw'];
      let bestResult = { size: Infinity, algorithm: '', data: null };
      
      for (const algo of algorithms) {
        try {
          const compressedData = await compress(inputText, algo);
          const compressedSize = compressedData.byteLength;
          
          if (compressedSize < bestResult.size) {
            bestResult = {
              size: compressedSize,
              algorithm: algo,
              data: arrayBufferToBase64(compressedData)
            };
          }
          
          logCompression(`${algo}: ${formatFileSize(compressedSize)}`);
        } catch (error) {
          logCompression(`–û—à–∏–±–∫–∞ ${algo}: ${error.message}`, 'error');
        }
      }
      
      if (bestResult.data) {
        const buttons = compressionElements.algorithmButtons.querySelectorAll('.algorithm-btn');
        buttons.forEach(btn => {
          btn.classList.toggle('active', btn.dataset.algorithm === bestResult.algorithm);
        });
        currentAlgorithm = bestResult.algorithm;
        
        compressionElements.output.value = bestResult.data;
        
        const originalSize = new TextEncoder().encode(inputText).length;
        updateCompressionStats(originalSize, bestResult.size, 0, bestResult.algorithm);
        
        logCompression(`–ê–≤—Ç–æ-—Å–∂–∞—Ç–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ. –õ—É—á—à–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º: ${bestResult.algorithm.toUpperCase()}`, 'success');
        showStatus(`‚úÖ –ê–≤—Ç–æ-—Å–∂–∞—Ç–∏–µ: ${bestResult.algorithm.toUpperCase()} (${((1 - bestResult.size/originalSize)*100).toFixed(2)}% —Å–∂–∞—Ç–∏—è)`);
      }
      
      resetButton();
    });

    // –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
    compressionElements.compareBtn.addEventListener('click', async function() {
      const inputText = compressionElements.input.value.trim();
      if (!inputText) {
        showStatus('–í–≤–µ–¥–∏—Ç–µ Base64 —Å—Ç—Ä–æ–∫—É –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è', 'error');
        return;
      }

      const resetButton = showButtonLoading(this, '–°—Ä–∞–≤–Ω–µ–Ω–∏–µ...');
      logCompression('–ó–∞–ø—É—Å–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤...');
      
      const algorithms = ['gzip', 'deflate', 'deflate-raw'];
      const results = [];
      const originalSize = new TextEncoder().encode(inputText).length;
      
      for (const algo of algorithms) {
        try {
          const startTime = performance.now();
          const compressedData = await compress(inputText, algo);
          const endTime = performance.now();
          
          const compressedSize = compressedData.byteLength;
          const ratio = ((1 - compressedSize / originalSize) * 100).toFixed(2);
          const time = (endTime - startTime).toFixed(2);
          
          results.push({
            algorithm: algo,
            size: compressedSize,
            ratio: ratio,
            time: time
          });
          
          logCompression(`${algo.toUpperCase()}: ${formatFileSize(compressedSize)} (${ratio}%, ${time}–º—Å)`);
        } catch (error) {
          logCompression(`–û—à–∏–±–∫–∞ ${algo}: ${error.message}`, 'error');
        }
      }
      
      // –ù–∞—Ö–æ–¥–∏–º –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
      const best = results.reduce((best, current) => 
        current.size < best.size ? current : best, { size: Infinity });
      
      if (best.size < Infinity) {
        compressionElements.output.value = arrayBufferToBase64(await compress(inputText, best.algorithm));
        
        const buttons = compressionElements.algorithmButtons.querySelectorAll('.algorithm-btn');
        buttons.forEach(btn => {
          btn.classList.toggle('active', btn.dataset.algorithm === best.algorithm);
        });
        currentAlgorithm = best.algorithm;
        
        updateCompressionStats(originalSize, best.size, 0, best.algorithm);
        
        logCompression(`–õ—É—á—à–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º: ${best.algorithm.toUpperCase()} (${best.ratio}% —Å–∂–∞—Ç–∏—è, ${best.time}–º—Å)`, 'success');
        showStatus(`‚úÖ –õ—É—á—à–∏–π: ${best.algorithm.toUpperCase()} (${best.ratio}% —Å–∂–∞—Ç–∏—è)`);
      }
      
      resetButton();
    });

    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
    compressionElements.copyOriginalBtn.addEventListener('click', function() {
      const text = compressionElements.input.value.trim();
      if (!text) {
        showStatus('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
        return;
      }

      navigator.clipboard.writeText(text).then(() => {
        logCompression('–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', 'success');
        showStatus('üìã –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
      }).catch(err => {
        compressionElements.input.select();
        document.execCommand('copy');
        logCompression('–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω (—Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥)', 'success');
        showStatus('üìã –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
      });
    });

    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∂–∞—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
    compressionElements.copyCompressedBtn.addEventListener('click', function() {
      const text = compressionElements.output.value.trim();
      if (!text) {
        showStatus('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
        return;
      }

      navigator.clipboard.writeText(text).then(() => {
        logCompression('–°–∂–∞—Ç—ã–π —Ç–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', 'success');
        showStatus('üìã –°–∂–∞—Ç—ã–π —Ç–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
      }).catch(err => {
        compressionElements.output.select();
        document.execCommand('copy');
        logCompression('–°–∂–∞—Ç—ã–π —Ç–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω (—Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥)', 'success');
        showStatus('üìã –°–∂–∞—Ç—ã–π —Ç–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
      });
    });

    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
    compressionElements.copyDecompressedBtn.addEventListener('click', function() {
      const text = compressionElements.decompressed.value.trim();
      if (!text) {
        showStatus('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
        return;
      }

      navigator.clipboard.writeText(text).then(() => {
        logCompression('–†–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', 'success');
        showStatus('üìã –†–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
      }).catch(err => {
        compressionElements.decompressed.select();
        document.execCommand('copy');
        logCompression('–†–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω (—Å—Ç–∞—Ä—ã–π –º–µ—Ç–æ–¥)', 'success');
        showStatus('üìã –†–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
      });
    });

    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∂–∞—Ç–æ–≥–æ Base64 –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    compressionElements.useForImageBtn.addEventListener('click', function() {
      const compressedText = compressionElements.output.value.trim();
      if (!compressedText) {
        showStatus('–ù–µ—Ç —Å–∂–∞—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö', 'error');
        return;
      }

      elements.base64Textarea.value = compressedText;
      compressionElements.input.value = compressedText;
      showStatus('‚úÖ –°–∂–∞—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ –ø–æ–ª–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
      logCompression('–°–∂–∞—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ –ø–æ–ª–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
    });

    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω–æ–≥–æ Base64 –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    compressionElements.useDecompressedBtn.addEventListener('click', function() {
      const decompressedText = compressionElements.decompressed.value.trim();
      if (!decompressedText) {
        showStatus('–ù–µ—Ç —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö', 'error');
        return;
      }

      elements.base64Textarea.value = decompressedText;
      compressionElements.input.value = decompressedText;
      showStatus('‚úÖ –†–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ –ø–æ–ª–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
      logCompression('–†–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ –ø–æ–ª–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
    });

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∂–∞—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    compressionElements.saveCompressedBtn.addEventListener('click', function() {
      const compressedText = compressionElements.output.value.trim();
      if (!compressedText) {
        showStatus('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
        return;
      }

      const resetButton = showButtonLoading(this, '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...');

      try {
        const blob = new Blob([compressedText], { type: 'text/plain;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `compressed_base64_${currentAlgorithm}_${new Date().getTime()}.txt`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        
        showStatus('üíæ –°–∂–∞—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
        logCompression(`–°–∂–∞—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª: ${link.download}`);
        resetButton();
      } catch (error) {
        showStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏: ' + error.message, 'error');
        logCompression(`–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ${error.message}`, 'error');
        resetButton();
      }
    });

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
    compressionElements.verifyIntegrityBtn.addEventListener('click', function() {
      const originalText = compressionElements.input.value.trim();
      const decompressedText = compressionElements.decompressed.value.trim();
      
      if (!originalText || !decompressedText) {
        showStatus('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏', 'error');
        return;
      }
      
      const integrity = originalText === decompressedText;
      
      if (integrity) {
        logCompression('–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏: ‚úÖ –î–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã', 'success');
        showStatus('‚úÖ –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!');
      } else {
        logCompression('–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏: ‚ùå –î–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã', 'error');
        showStatus('‚ùå –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Ä—É—à–µ–Ω–∞!', 'error');
      }
      
      updateCompressionStats(
        new TextEncoder().encode(originalText).length,
        new TextEncoder().encode(compressionElements.output.value.trim()).length,
        new TextEncoder().encode(decompressedText).length,
        currentAlgorithm,
        integrity
      );
    });

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
    compressionElements.validateOriginalBtn.addEventListener('click', function() {
      const text = compressionElements.input.value.trim();
      if (!text) {
        showStatus('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏', 'error');
        return;
      }

      try {
        atob(text);
        logCompression('–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç: ‚úÖ –í–∞–ª–∏–¥–Ω—ã–π Base64', 'success');
        showStatus('‚úÖ –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –≤–∞–ª–∏–¥–µ–Ω!');
      } catch (error) {
        logCompression('–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç: ‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π Base64', 'error');
        showStatus('‚ùå –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–µ–≤–∞–ª–∏–¥–µ–Ω!', 'error');
      }
    });

    // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    compressionElements.loadFromImageBtn.addEventListener('click', function() {
      const imageBase64 = elements.base64Textarea.value.trim();
      if (!imageBase64) {
        showStatus('–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ Base64 –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è', 'error');
        return;
      }

      compressionElements.input.value = imageBase64;
      logCompression('Base64 –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ –ø–æ–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è', 'success');
      showStatus('‚úÖ Base64 –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è!');
    });

    // –ü–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏ –ø–æ–ª—è
    compressionElements.swapFieldsBtn.addEventListener('click', function() {
      const original = compressionElements.input.value;
      const compressed = compressionElements.output.value;
      
      compressionElements.input.value = compressed;
      compressionElements.output.value = original;
      
      logCompression('–ü–æ–ª—è "–ò—Å—Ö–æ–¥–Ω—ã–π" –∏ "–°–∂–∞—Ç—ã–π" –ø–æ–º–µ–Ω—è–Ω—ã –º–µ—Å—Ç–∞–º–∏');
      showStatus('üîÑ –ü–æ–ª—è –ø–æ–º–µ–Ω—è–Ω—ã –º–µ—Å—Ç–∞–º–∏');
    });

    // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª–µ–π —Å–∂–∞—Ç–∏—è
    compressionElements.clearCompressionBtn.addEventListener('click', function() {
      compressionElements.input.value = '';
      compressionElements.output.value = '';
      compressionElements.decompressed.value = '';
      compressionElements.compressionLog.innerHTML = '<div class="log-entry">–ñ—É—Ä–Ω–∞–ª —Å–∂–∞—Ç–∏—è: –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ</div>';
      updateCompressionStats(0, 0, 0, '-', null);
      showStatus('üóëÔ∏è –ü–æ–ª—è —Å–∂–∞—Ç–∏—è –æ—á–∏—â–µ–Ω—ã');
      logCompression('–í—Å–µ –ø–æ–ª—è —Å–∂–∞—Ç–∏—è –æ—á–∏—â–µ–Ω—ã', 'info');
    });

    // ========== –°–£–©–ï–°–¢–í–£–Æ–©–ò–ï –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò ==========

    // –ü–æ–∫–∞–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ
    function showFileInfo(file) {
      if (!file) {
        elements.fileInfo.style.display = 'none';
        return;
      }
      
      const fileSize = formatFileSize(file.size);
      const fileType = file.type || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø';
      elements.fileInfo.innerHTML = `
        <strong>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ:</strong><br>
        üìÅ –ò–º—è: ${file.name}<br>
        üìä –†–∞–∑–º–µ—Ä: ${fileSize}<br>
        üè∑Ô∏è –¢–∏–ø: ${fileType}
      `;
      elements.fileInfo.style.display = 'block';
    }

    // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ Base64
    elements.convertToTextBtn.addEventListener('click', function() {
      const file = elements.imageInput.files[0];
      if (!file) {
        showStatus('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ', 'error');
        return;
      }

      if (file.size > 10 * 1024 * 1024) {
        showStatus('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–æ 10MB.', 'error');
        return;
      }

      const resetButton = showButtonLoading(this, '–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º...');

      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const fullDataUrl = e.target.result;
          const base64 = fullDataUrl.split(',')[1];
          elements.base64Textarea.value = base64;
          compressionElements.input.value = base64;
          
          elements.inputPreview.innerHTML = `<img src="${fullDataUrl}" alt="–ò—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">`;
          
          showStatus(`‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–æ! Base64 –¥–ª–∏–Ω–∞: ${base64.length} —Å–∏–º–≤–æ–ª–æ–≤`);
          logCompression(`Base64 —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: ${formatFileSize(base64.length)}`);
        } catch (error) {
          showStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏: ' + error.message, 'error');
        } finally {
          resetButton();
        }
      };
      
      reader.onerror = function() {
        showStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞', 'error');
        resetButton();
      };
      
      reader.readAsDataURL(file);
    });

    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ Base64
    elements.convertToImageBtn.addEventListener('click', function() {
      const base64 = elements.base64Textarea.value.trim();
      if (!base64) {
        showStatus('–ü–æ–ª–µ Base64 –ø—É—Å—Ç–æ–µ', 'error');
        return;
      }

      const resetButton = showButtonLoading(this, '–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º...');

      try {
        let mimeType = 'image/png';
        if (base64.startsWith('/9j/') || base64.startsWith('/9j/4AAQ')) mimeType = 'image/jpeg';
        else if (base64.startsWith('R0lGODlh')) mimeType = 'image/gif';
        else if (base64.startsWith('UklGR')) mimeType = 'image/webp';
        else if (base64.startsWith('Qk0')) mimeType = 'image/bmp';

        const dataUrl = `data:${mimeType};base64,${base64}`;
        
        const img = new Image();
        img.onload = function() {
          elements.outputPreview.innerHTML = `<img src="${dataUrl}" alt="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">`;
          showStatus('‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!');
          resetButton();
        };
        img.onerror = function() {
          showStatus('‚ùå –û—à–∏–±–∫–∞: –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç Base64 —Å—Ç—Ä–æ–∫–∏', 'error');
          elements.outputPreview.innerHTML = '<div class="preview-placeholder">–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>';
          resetButton();
        };
        img.src = dataUrl;
      } catch (error) {
        showStatus('‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: ' + error.message, 'error');
        resetButton();
      }
    });

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ Base64 –≤ TXT-—Ñ–∞–π–ª
    elements.saveToTxtBtn.addEventListener('click', function() {
      const base64 = elements.base64Textarea.value.trim();
      if (!base64) {
        showStatus('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
        return;
      }

      const resetButton = showButtonLoading(this, '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...');

      try {
        const blob = new Blob([base64], { type: 'text/plain;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `image_base64_${new Date().getTime()}.txt`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        
        showStatus('üíæ –§–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
        resetButton();
      } catch (error) {
        showStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏: ' + error.message, 'error');
        resetButton();
      }
    });

    // –ó–∞–≥—Ä—É–∑–∫–∞ Base64 –∏–∑ TXT-—Ñ–∞–π–ª–∞
    elements.txtInput.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) {
        showStatus('–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω', 'error');
        return;
      }

      if (!file.name.toLowerCase().endsWith('.txt')) {
        showStatus('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ TXT-—Ñ–∞–π–ª', 'error');
        this.value = '';
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const text = e.target.result.trim();
          
          if (text.length < 20 || !/^[A-Za-z0-9+/]*={0,2}$/.test(text)) {
            showStatus('–§–∞–π–ª –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞–ª–∏–¥–Ω—É—é Base64 —Å—Ç—Ä–æ–∫—É', 'error');
            return;
          }
          
          elements.base64Textarea.value = text;
          compressionElements.input.value = text;
          showStatus('üìÇ Base64 —Å—Ç—Ä–æ–∫–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ —Ñ–∞–π–ª–∞!');
          logCompression('Base64 —Å—Ç—Ä–æ–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ —Ñ–∞–π–ª–∞', 'success');
        } catch (error) {
          showStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞: ' + error.message, 'error');
        }
      };
      
      reader.onerror = function() {
        showStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞', 'error');
      };
      
      reader.readAsText(file, 'utf-8');
    });

    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ Base64 –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
    elements.copyBase64Btn.addEventListener('click', function() {
      const base64 = elements.base64Textarea.value.trim();
      if (!base64) {
        showStatus('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
        return;
      }

      navigator.clipboard.writeText(base64).then(() => {
        showStatus('üìã Base64 —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
      }).catch(err => {
        elements.base64Textarea.select();
        document.execCommand('copy');
        showStatus('üìã Base64 —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
      });
    });

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ Base64
    elements.validateBase64Btn.addEventListener('click', function() {
      const base64 = elements.base64Textarea.value.trim();
      if (!base64) {
        showStatus('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏', 'error');
        return;
      }

      try {
        atob(base64);
        showStatus('‚úÖ Base64 —Å—Ç—Ä–æ–∫–∞ –≤–∞–ª–∏–¥–Ω–∞!');
        logCompression('Base64 —Å—Ç—Ä–æ–∫–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ - –≤–∞–ª–∏–¥–Ω–∞', 'success');
      } catch (error) {
        showStatus('‚ùå Base64 —Å—Ç—Ä–æ–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω–∞', 'error');
        logCompression('Base64 —Å—Ç—Ä–æ–∫–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ - –Ω–µ–≤–∞–ª–∏–¥–Ω–∞', 'error');
      }
    });

    // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ–≥–æ
    elements.clearAllBtn.addEventListener('click', function() {
      elements.imageInput.value = '';
      elements.txtInput.value = '';
      elements.base64Textarea.value = '';
      compressionElements.input.value = '';
      compressionElements.output.value = '';
      compressionElements.decompressed.value = '';
      elements.inputPreview.innerHTML = '<div class="preview-placeholder">–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>';
      elements.outputPreview.innerHTML = '<div class="preview-placeholder">–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>';
      elements.fileInfo.style.display = 'none';
      compressionElements.compressionLog.innerHTML = '<div class="log-entry">–ñ—É—Ä–Ω–∞–ª —Å–∂–∞—Ç–∏—è: –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ</div>';
      updateCompressionStats(0, 0, 0, '-', null);
      showStatus('üóëÔ∏è –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã');
      logCompression('–í—Å–µ –ø–æ–ª—è –æ—á–∏—â–µ–Ω—ã', 'info');
    });

    // –ü–æ–∫–∞–∑ –ø—Ä–µ–≤—å—é –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    elements.imageInput.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;

      showFileInfo(file);

      if (file.size > 10 * 1024 * 1024) {
        showStatus('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–æ 10MB.', 'error');
        this.value = '';
        elements.fileInfo.style.display = 'none';
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        elements.inputPreview.innerHTML = `<img src="${e.target.result}" alt="–í—ã–±—Ä–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">`;
      };
      reader.readAsDataURL(file);
    });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    window.addEventListener('load', function() {
      showStatus('üëÜ –í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ Base64 —Å—Ç—Ä–æ–∫—É –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã', 'info');
      initAlgorithmButtons();
      syncBase64Fields();
      logCompression('–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å–∂–∞—Ç–∏—è Base64 –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω', 'info');
    });

    // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
    document.addEventListener('keydown', function(e) {
      if ((e.ctrlKey || e.metaKey)) {
        switch(e.key) {
          case 's':
            e.preventDefault();
            elements.saveToTxtBtn.click();
            break;
          case 'c':
            if (elements.base64Textarea === document.activeElement) {
              elements.copyBase64Btn.click();
            } else if (compressionElements.output === document.activeElement) {
              compressionElements.copyCompressedBtn.click();
            } else if (compressionElements.decompressed === document.activeElement) {
              compressionElements.copyDecompressedBtn.click();
            } else if (compressionElements.input === document.activeElement) {
              compressionElements.copyOriginalBtn.click();
            }
            break;
          case 'd':
            e.preventDefault();
            elements.clearAllBtn.click();
            break;
          case '1':
            e.preventDefault();
            compressionElements.compressBtn.click();
            break;
          case '2':
            e.preventDefault();
            compressionElements.decompressBtn.click();
            break;
          case '3':
            e.preventDefault();
            compressionElements.autoCompressBtn.click();
            break;
        }
      }
    });

    // –ü–æ–∫–∞–∑ –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
    const tooltips = {
      saveToTxtBtn: 'Ctrl+S',
      copyBase64Btn: 'Ctrl+C',
      clearAllBtn: 'Ctrl+D',
      compressBtn: 'Ctrl+1',
      decompressBtn: 'Ctrl+2',
      autoCompressBtn: 'Ctrl+3'
    };

    Object.keys(tooltips).forEach(btnId => {
      const btn = elements[btnId] || compressionElements[btnId];
      if (btn) {
        btn.title = tooltips[btnId];
      }
    });
  </script>
</body>
</html>