<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä —Ñ–æ—Ç–æ ‚Üî —Å—Ç—Ä–æ–∫–∞</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #ff9a00 0%, #ff6a00 100%);
      color: #333;
      margin: 0;
      padding: 20px;
      min-height: 100vh;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      min-height: 80vh;
    }
    
    h1 {
      text-align: center;
      color: #ff6a00;
      font-size: 2.2em;
      margin-bottom: 30px;
      grid-column: 1 / -1;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .panel {
      background: #fffaf5;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 4px 15px rgba(255, 106, 0, 0.1);
      border: 1px solid #ffe0cc;
    }
    
    .panel h2 {
      color: #cc5500;
      margin-bottom: 20px;
      font-size: 1.4em;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .section {
      margin-bottom: 25px;
    }
    
    label {
      display: block;
      margin-bottom: 12px;
      font-weight: 600;
      color: #cc5500;
      font-size: 1.1em;
    }
    
    input[type="file"] {
      width: 100%;
      margin-bottom: 15px;
      padding: 15px;
      border: 2px dashed #ffa366;
      border-radius: 8px;
      background: #fff5eb;
      font-size: 14px;
      transition: all 0.3s ease;
    }
    
    input[type="file"]:hover {
      border-color: #ff6a00;
      background: #ffebd9;
    }
    
    textarea {
      width: 100%;
      height: 200px;
      padding: 15px;
      border: 2px solid #ffa366;
      border-radius: 8px;
      font-family: 'Consolas', 'Monaco', monospace;
      resize: vertical;
      font-size: 13px;
      line-height: 1.4;
      transition: border-color 0.3s ease;
      background: #fffaf5;
    }
    
    textarea:focus {
      outline: none;
      border-color: #ff6a00;
      box-shadow: 0 0 0 3px rgba(255, 106, 0, 0.1);
    }
    
    .button-group {
      display: flex;
      gap: 12px;
      margin: 15px 0;
      flex-wrap: wrap;
    }
    
    button {
      background: linear-gradient(135deg, #ff9a00 0%, #ff6a00 100%);
      color: white;
      border: none;
      padding: 14px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      flex: 1;
      min-width: 160px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(255, 106, 0, 0.2);
      position: relative;
      overflow: hidden;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 106, 0, 0.3);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    button.secondary {
      background: linear-gradient(135deg, #ff8c42 0%, #e65c00 100%);
      box-shadow: 0 4px 15px rgba(255, 140, 66, 0.2);
    }
    
    button.secondary:hover {
      box-shadow: 0 6px 20px rgba(255, 140, 66, 0.3);
    }
    
    .file-input-wrapper {
      position: relative;
      flex: 1;
      min-width: 160px;
    }
    
    .file-input-wrapper input[type="file"] {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
      margin: 0;
      padding: 0;
      z-index: 2;
    }
    
    .file-input-button {
      display: block;
      width: 100%;
      text-align: center;
      margin: 0;
      pointer-events: none;
      z-index: 1;
      position: relative;
    }
    
    .preview-container {
      margin-top: 20px;
      text-align: center;
    }
    
    .preview {
      border: 2px dashed #ffa366;
      border-radius: 8px;
      padding: 20px;
      min-height: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fffaf5;
      transition: border-color 0.3s ease;
    }
    
    .preview:hover {
      border-color: #ff6a00;
    }
    
    .preview img {
      max-width: 100%;
      max-height: 300px;
      border-radius: 6px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    
    .preview-placeholder {
      color: #ff8c42;
      font-style: italic;
    }
    
    .status {
      padding: 12px 16px;
      margin: 15px 0;
      border-radius: 8px;
      font-weight: 500;
      text-align: center;
      transition: all 0.3s ease;
    }
    
    .status.success {
      background: #ffe6cc;
      color: #cc5500;
      border: 1px solid #ffd9b3;
    }
    
    .status.error {
      background: #ffddcc;
      color: #cc4400;
      border: 1px solid #ffccb3;
    }
    
    .status.info {
      background: #fff0e0;
      color: #cc5500;
      border: 1px solid #ffddcc;
    }
    
    .tools-panel {
      grid-column: 1 / -1;
      background: #fffaf5;
      border-radius: 12px;
      padding: 20px;
      margin-top: 10px;
      border: 1px solid #ffe0cc;
    }
    
    .tools-panel h3 {
      color: #cc5500;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .tool-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 12px;
    }
    
    .file-info {
      background: #ffe6cc;
      padding: 10px 15px;
      border-radius: 6px;
      margin: 10px 0;
      font-size: 0.9em;
      color: #cc5500;
    }
    
    /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .panel {
      animation: fadeIn 0.5s ease-out;
    }
    
    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
    @media (max-width: 768px) {
      .container {
        grid-template-columns: 1fr;
        padding: 20px;
        gap: 20px;
      }
      
      h1 {
        font-size: 1.8em;
      }
      
      .button-group {
        flex-direction: column;
      }
      
      button, .file-input-wrapper {
        width: 100%;
        min-width: auto;
      }
      
      body {
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üñºÔ∏è –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚Üî Base64</h1>
    
    <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ Base64 -->
    <div class="panel">
      <h2>üì∑ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üí Base64</h2>
      
      <div class="section">
        <label>–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:</label>
        <input type="file" id="imageInput" accept="image/*" />
        <div class="file-info" id="fileInfo" style="display: none;"></div>
        
        <div class="button-group">
          <button id="convertToTextBtn">üîÑ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ Base64</button>
        </div>
        
        <div class="preview-container">
          <div class="preview" id="inputPreview">
            <div class="preview-placeholder">–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å: Base64 –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
    <div class="panel">
      <h2>üìÑ Base64 ‚Üí –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</h2>
      
      <div class="section">
        <label>–°—Ç—Ä–æ–∫–∞ Base64:</label>
        <textarea id="base64String" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ Base64 —Å—Ç—Ä–æ–∫—É –∏–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –µ—ë –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è..."></textarea>
        
        <div class="button-group">
          <button id="convertToImageBtn">üñºÔ∏è –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</button>
          <div class="file-input-wrapper">
            <input type="file" id="txtInput" accept=".txt" />
            <button class="file-input-button secondary">üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ TXT</button>
          </div>
        </div>
        
        <div class="preview-container">
          <div class="preview" id="outputPreview">
            <div class="preview-placeholder">–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ -->
    <div class="tools-panel">
      <h3>üõ†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h3>
      <div class="tool-buttons">
        <button id="saveToTxtBtn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å Base64 –≤ TXT</button>
        <button id="clearAllBtn">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë</button>
        <button id="copyBase64Btn">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å Base64</button>
        <button id="validateBase64Btn">‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Base64</button>
      </div>
    </div>
    
    <div id="statusMessage" class="status" style="display: none;"></div>
  </div>

  <script>
    // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
    const elements = {
      imageInput: document.getElementById('imageInput'),
      txtInput: document.getElementById('txtInput'),
      base64Textarea: document.getElementById('base64String'),
      inputPreview: document.getElementById('inputPreview'),
      outputPreview: document.getElementById('outputPreview'),
      statusMessage: document.getElementById('statusMessage'),
      fileInfo: document.getElementById('fileInfo'),
      convertToTextBtn: document.getElementById('convertToTextBtn'),
      convertToImageBtn: document.getElementById('convertToImageBtn'),
      saveToTxtBtn: document.getElementById('saveToTxtBtn'),
      clearAllBtn: document.getElementById('clearAllBtn'),
      copyBase64Btn: document.getElementById('copyBase64Btn'),
      validateBase64Btn: document.getElementById('validateBase64Btn')
    };

    // –ü–æ–∫–∞–∑ —Å—Ç–∞—Ç—É—Å–∞
    function showStatus(message, type = 'info') {
      elements.statusMessage.textContent = message;
      elements.statusMessage.className = `status ${type}`;
      elements.statusMessage.style.display = 'block';
      
      setTimeout(() => {
        elements.statusMessage.style.display = 'none';
      }, 4000);
    }

    // –ü–æ–∫–∞–∑ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –∫–Ω–æ–ø–∫–µ
    function showButtonLoading(button, text) {
      const originalText = button.innerHTML;
      button.innerHTML = '‚è≥ ' + text;
      button.disabled = true;
      
      return () => {
        button.innerHTML = originalText;
        button.disabled = false;
      };
    }

    // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    // –ü–æ–∫–∞–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ
    function showFileInfo(file) {
      if (!file) {
        elements.fileInfo.style.display = 'none';
        return;
      }
      
      const fileSize = formatFileSize(file.size);
      const fileType = file.type || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø';
      elements.fileInfo.innerHTML = `
        <strong>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ñ–∞–π–ª–µ:</strong><br>
        üìÅ –ò–º—è: ${file.name}<br>
        üìä –†–∞–∑–º–µ—Ä: ${fileSize}<br>
        üè∑Ô∏è –¢–∏–ø: ${fileType}
      `;
      elements.fileInfo.style.display = 'block';
    }

    // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ Base64
    elements.convertToTextBtn.addEventListener('click', function() {
      const file = elements.imageInput.files[0];
      if (!file) {
        showStatus('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ', 'error');
        return;
      }

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ (—É–≤–µ–ª–∏—á–∏–º –ª–∏–º–∏—Ç –¥–ª—è desktop)
      if (file.size > 10 * 1024 * 1024) {
        showStatus('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–æ 10MB.', 'error');
        return;
      }

      const resetButton = showButtonLoading(this, '–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º...');

      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const fullDataUrl = e.target.result;
          const base64 = fullDataUrl.split(',')[1];
          elements.base64Textarea.value = base64;
          
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–≤—å—é
          elements.inputPreview.innerHTML = `<img src="${fullDataUrl}" alt="–ò—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">`;
          
          showStatus(`‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–æ! Base64 –¥–ª–∏–Ω–∞: ${base64.length} —Å–∏–º–≤–æ–ª–æ–≤`);
        } catch (error) {
          showStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏: ' + error.message, 'error');
        } finally {
          resetButton();
        }
      };
      
      reader.onerror = function() {
        showStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞', 'error');
        resetButton();
      };
      
      reader.readAsDataURL(file);
    });

    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ Base64
    elements.convertToImageBtn.addEventListener('click', function() {
      const base64 = elements.base64Textarea.value.trim();
      if (!base64) {
        showStatus('–ü–æ–ª–µ Base64 –ø—É—Å—Ç–æ–µ', 'error');
        return;
      }

      const resetButton = showButtonLoading(this, '–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º...');

      try {
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º MIME-—Ç–∏–ø
        let mimeType = 'image/png';
        if (base64.startsWith('/9j/') || base64.startsWith('/9j/4AAQ')) mimeType = 'image/jpeg';
        else if (base64.startsWith('R0lGODlh')) mimeType = 'image/gif';
        else if (base64.startsWith('UklGR')) mimeType = 'image/webp';
        else if (base64.startsWith('Qk0')) mimeType = 'image/bmp';

        const dataUrl = `data:${mimeType};base64,${base64}`;
        
        // –°–æ–∑–¥–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        const img = new Image();
        img.onload = function() {
          elements.outputPreview.innerHTML = `<img src="${dataUrl}" alt="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">`;
          showStatus('‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!');
          resetButton();
        };
        img.onerror = function() {
          showStatus('‚ùå –û—à–∏–±–∫–∞: –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç Base64 —Å—Ç—Ä–æ–∫–∏', 'error');
          elements.outputPreview.innerHTML = '<div class="preview-placeholder">–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>';
          resetButton();
        };
        img.src = dataUrl;
      } catch (error) {
        showStatus('‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: ' + error.message, 'error');
        resetButton();
      }
    });

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ Base64 –≤ TXT-—Ñ–∞–π–ª
    elements.saveToTxtBtn.addEventListener('click', function() {
      const base64 = elements.base64Textarea.value.trim();
      if (!base64) {
        showStatus('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
        return;
      }

      const resetButton = showButtonLoading(this, '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...');

      try {
        const blob = new Blob([base64], { type: 'text/plain;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `image_base64_${new Date().getTime()}.txt`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        
        showStatus('üíæ –§–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
        resetButton();
      } catch (error) {
        showStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏: ' + error.message, 'error');
        resetButton();
      }
    });

    // –ó–∞–≥—Ä—É–∑–∫–∞ Base64 –∏–∑ TXT-—Ñ–∞–π–ª–∞ - –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø
    elements.txtInput.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) {
        showStatus('–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω', 'error');
        return;
      }

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
      if (!file.name.toLowerCase().endsWith('.txt')) {
        showStatus('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ TXT-—Ñ–∞–π–ª', 'error');
        this.value = '';
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const text = e.target.result.trim();
          
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –ø–æ—Ö–æ–∂ –Ω–∞ Base64
          if (text.length < 20 || !/^[A-Za-z0-9+/]*={0,2}$/.test(text)) {
            showStatus('–§–∞–π–ª –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞–ª–∏–¥–Ω—É—é Base64 —Å—Ç—Ä–æ–∫—É', 'error');
            return;
          }
          
          elements.base64Textarea.value = text;
          showStatus('üìÇ Base64 —Å—Ç—Ä–æ–∫–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ —Ñ–∞–π–ª–∞!');
        } catch (error) {
          showStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞: ' + error.message, 'error');
        }
      };
      
      reader.onerror = function() {
        showStatus('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞', 'error');
      };
      
      reader.readAsText(file, 'utf-8');
    });

    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ Base64 –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
    elements.copyBase64Btn.addEventListener('click', function() {
      const base64 = elements.base64Textarea.value.trim();
      if (!base64) {
        showStatus('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
        return;
      }

      navigator.clipboard.writeText(base64).then(() => {
        showStatus('üìã Base64 —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
      }).catch(err => {
        // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
        elements.base64Textarea.select();
        document.execCommand('copy');
        showStatus('üìã Base64 —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
      });
    });

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ Base64
    elements.validateBase64Btn.addEventListener('click', function() {
      const base64 = elements.base64Textarea.value.trim();
      if (!base64) {
        showStatus('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏', 'error');
        return;
      }

      try {
        // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Base64
        const binaryString = atob(base64);
        showStatus('‚úÖ Base64 —Å—Ç—Ä–æ–∫–∞ –≤–∞–ª–∏–¥–Ω–∞!');
      } catch (error) {
        showStatus('‚ùå Base64 —Å—Ç—Ä–æ–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω–∞', 'error');
      }
    });

    // –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ–≥–æ
    elements.clearAllBtn.addEventListener('click', function() {
      elements.imageInput.value = '';
      elements.txtInput.value = '';
      elements.base64Textarea.value = '';
      elements.inputPreview.innerHTML = '<div class="preview-placeholder">–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>';
      elements.outputPreview.innerHTML = '<div class="preview-placeholder">–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>';
      elements.fileInfo.style.display = 'none';
      showStatus('üóëÔ∏è –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã');
    });

    // –ü–æ–∫–∞–∑ –ø—Ä–µ–≤—å—é –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    elements.imageInput.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;

      showFileInfo(file);

      if (file.size > 10 * 1024 * 1024) {
        showStatus('–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–æ 10MB.', 'error');
        this.value = '';
        elements.fileInfo.style.display = 'none';
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        elements.inputPreview.innerHTML = `<img src="${e.target.result}" alt="–í—ã–±—Ä–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ">`;
      };
      reader.readAsDataURL(file);
    });

    // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤—É—é –æ–±–ª–∞—Å—Ç—å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    window.addEventListener('load', function() {
      showStatus('üëÜ –í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ Base64 —Å—Ç—Ä–æ–∫—É –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã', 'info');
    });

    // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
    document.addEventListener('keydown', function(e) {
      if ((e.ctrlKey || e.metaKey)) {
        switch(e.key) {
          case 's':
            e.preventDefault();
            elements.saveToTxtBtn.click();
            break;
          case 'c':
            if (elements.base64Textarea === document.activeElement) {
              elements.copyBase64Btn.click();
            }
            break;
          case 'd':
            e.preventDefault();
            elements.clearAllBtn.click();
            break;
        }
      }
    });

    // –ü–æ–∫–∞–∑ –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
    const tooltips = {
      saveToTxtBtn: 'Ctrl+S',
      copyBase64Btn: 'Ctrl+C',
      clearAllBtn: 'Ctrl+D'
    };

    Object.keys(tooltips).forEach(btnId => {
      const btn = elements[btnId];
      if (btn) {
        btn.title = tooltips[btnId];
      }
    });
  </script>
</body>
</html>